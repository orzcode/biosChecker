<!-- Ko-Fi Modal Component -->
<button id="showKoFi">Support project
	<img src="images/kofi_symbol.svg" width="20" height="16" alt="Ko-Fi" class="kofi-icon" loading="lazy">
  </button>
  
  <div id="koFiModal" class="modal">
	<div class="modal-content">
	  <span class="close">&times;</span>
	</div>
  </div>
  
  <style>
	/* Modal Styling */
	.modal { 
	  display: none; position: fixed; z-index: 1000; left: 0; top: 0; 
	  width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.5);
	  justify-content: center; align-items: center; opacity: 0; 
	  transition: opacity 0.3s ease-in-out; 
	}
	.modal-content { 
	  background-color: #ffffff; padding: 10px; border-radius: 8px; max-width: 80%;
	  position: relative; transform: translateY(-20px); transition: transform 0.3s ease-in-out; 
	}
	.close { 
	  position: absolute; top: 10px; right: 15px; font-size: 24px; 
	  cursor: pointer; color: #555; transition: color 0.2s; 
	}
	.close:hover { color: #ff0000; }
	.modal.show { display: flex; opacity: 1; }
	.modal.show .modal-content { transform: translateY(0); }
  
	/* Button Styling */
	#showKoFi {
	  display: inline-flex; align-items: center; gap: 8px;
	  background: #6b9b1d; color: white; border: 1px solid black; padding: 0.1rem 0.5rem 0.2rem 0.5rem;
	  font-size: clamp(1.4rem, 2vw, 1.8rem); cursor: pointer; border-radius: 8px;
	  transition: background 0.3s ease-in-out;
	  max-width: fit-content;
	}
	#showKoFi:hover { filter: brightness(1.1); }
  
	/* Ko-Fi Icon */
	.kofi-icon {
	  width: 20px; height: auto;
	}
  </style>
  
  <script>
	document.addEventListener("DOMContentLoaded", () => {
	  const modal = document.getElementById("koFiModal");
	  const showBtn = document.getElementById("showKoFi");
	  const closeBtn = document.createElement("span");
	  closeBtn.innerHTML = "&times;";
	  closeBtn.className = "close";
	  document.querySelector(".modal-content").appendChild(closeBtn);
  
	  let iframeLoaded = false; // Track whether iframe is created
  
	  showBtn.addEventListener("click", () => {
		modal.style.display = "flex";
		setTimeout(() => modal.classList.add("show"), 10);
  
		if (!iframeLoaded) {
		  // Prevent unload event listeners for bfcache compatibility
		  (function(w) {
			const originalAddEventListener = w.addEventListener;
			w.addEventListener = function(type, listener, options) {
			  if (type === "unload") {
				originalAddEventListener.call(w, "pagehide", listener, options);
				return;
			  }
			  originalAddEventListener.call(w, type, listener, options);
			};
		  })(window);
  
		  const iframe = document.createElement("iframe");
		  iframe.src = "https://ko-fi.com/orzcode/?hidefeed=true&widget=true&embed=true&preview=true";
		  iframe.style.border = "none";
		  iframe.style.width = "100%";
		  iframe.style.background = "#202020";
		  iframe.height = "600";
		  iframe.title = "Support project";
		  iframe.loading = "lazy"; // Ensure it's still lazy-loaded
		  document.querySelector(".modal-content").appendChild(iframe);
		  iframeLoaded = true; // Prevents creating multiple iframes
		}
	  });
  
	  closeBtn.addEventListener("click", () => {
		modal.classList.remove("show");
		setTimeout(() => modal.style.display = "none", 300);
	  });
  
	  window.addEventListener("click", (event) => {
		if (event.target === modal) {
		  modal.classList.remove("show");
		  setTimeout(() => modal.style.display = "none", 300);
		}
	  });
	});
  </script>
  
  
  <!-- Preload Styles Efficiently -->
  <link rel="preload" href="/css/style.css" as="style" onload="this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="/css/style.css"></noscript>
  